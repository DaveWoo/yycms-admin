/*! table for Layui,Author:www.yyinfos.com 2018-09-19 */

layui.config({}).extend({}).define(["laytpl","laypage","layer","form"],function(e){"use strict";var v=layui.$,u=layui.laytpl,t=layui.laypage,m=layui.layer,o=layui.form,h=layui.hint(),b=layui.device(),x={config:{indexName:"lay_table_index",cols:{isCheckName:"lay_is_checked",isRadio:"lay_is_radio",isOpen:"lay_is_open",isShow:"lay_is_show",level:"lay_level",children:"children",cheDisabled:"lay_che_disabled",radDisabled:"lay_rad_disabled",iconOpen:"lay_icon_open",iconClose:"lay_icon_close",icon:"lay_icon"},initWidth:{checkbox:48,space:15,numbers:40,radio:48}},cache:{tableId:{data:{list:[],map:{},treeList:[],upIds:[]}},cla:{claIds:{tableId:!0},claObjs:{tableId:{}}},selectcode:{demokey:[{key:{value:""}}]}},index:layui.table?layui.table.index+1e4:0,set:function(e){var t=this;return t.config=v.extend({},t.config,e),t},on:function(e,t){return layui.onevent.call(this,p,e,t)},getClass:function(e){return x.cache.cla.claObjs[e]},pushClass:function(e,t){x.cache.cla.claObjs[e]=t},isCalss:function(e){return(this.cache.cla.claIds||{}).hasOwnProperty(e)||!1},isClassYes:function(e){return(this.cache.cla.claIds||{})[e]||!1},pushClassIds:function(e,t){this.cache.cla.claIds[e]=t},setObj:function(e,t,i){this.obj[e]||(this.obj[e]={}),this.obj[e][t]=i},getObj:function(e,t){return this.obj[e]?this.obj[e][t]:null},getDataList:function(e){return x.cache[e]?x.cache[e].data.list:[]},setDataList:function(e,t){x.cache[e]||(x.cache[e]={}),x.cache[e].data||(x.cache[e].data={}),x.cache[e].data.list||(x.cache[e].data.list=[]),x.cache[e].data.list=t},getDataMap:function(e){return x.cache[e]?x.cache[e].data.map:{}},setDataMap:function(e,t){x.cache[e]||(x.cache[e]={}),x.cache[e].data||(x.cache[e].data={}),x.cache[e].data.map||(x.cache[e].data.map={}),x.cache[e].data.map=t},getDataTreeList:function(e){return x.cache[e]?x.cache[e].data.treeList:[]},setDataTreeList:function(e,t){x.cache[e]||(x.cache[e]={}),x.cache[e].data||(x.cache[e].data={}),x.cache[e].data.treeList||(x.cache[e].data.treeList={}),x.cache[e].data.treeList=t},getDataRootList:function(e){return x.cache[e]&&x.cache[e].data.upIds||[]},setDataRootList:function(e,t){x.cache[e]||(x.cache[e]={}),x.cache[e].data||(x.cache[e].data={}),x.cache[e].data.upIds||(x.cache[e].data.upIds=[]),x.cache[e].data.upIds=t},init:function(i,a){a=a||{};var e=v(i?'table[lay-filter="'+i+'"]':n+"[lay-data]"),r="Table element property lay-data configuration item has a syntax error: ";return e.each(function(){var e=v(this),t=e.attr("lay-data");try{t=new Function("return "+t)()}catch(e){h.error(r+t)}var l=[],o=v.extend({elem:this,cols:[],data:[],skin:e.attr("lay-skin"),size:e.attr("lay-size"),even:"string"==typeof e.attr("lay-even")},x.config,a,t);i&&e.hide(),e.find("thead>tr").each(function(n){o.cols[n]=[],v(this).children().each(function(e){var t=v(this),i=t.attr("lay-data");try{i=new Function("return "+i)()}catch(e){return h.error(r+i)}var a=v.extend({title:t.text(),colspan:t.attr("colspan")||0,rowspan:t.attr("rowspan")||0},i);a.colspan<2&&l.push(a),o.cols[n].push(a)})}),e.find("tbody>tr").each(function(e){var a=v(this),n={};a.children("td").each(function(e,t){var i=v(this),a=i.data("field");if(a)return n[a]=i.html()}),layui.each(l,function(e,t){var i=a.children("td").eq(e);n[t.field]=i.html()}),o.data[e]=n}),x.render(o)}),this},render:function(e){x.pushClassIds(e.id);var t=new S(e);return a.call(t)},ready:function(i,a){var n=!1,l=new Date;i&&a&&setTimeout(function e(){if(i){var t=x.getClass(i);t&&t.hasOwnProperty("layBody")?(a(t),n=!0):(new Date).getTime()-l.getTime()<=1e4&&!n&&setTimeout(e,50)}},50)},checkStatus:function(e){var i=0,a=0,n=[],t=x.getDataList(e)||[];return layui.each(t,function(e,t){t.constructor!==Array?t[x.config.cols.isCheckName]&&(i++,n.push(x.clearCacheKey(t))):a++}),{data:n,isAll:!!t.length&&i===t.length-a}},setCheckStatus:function(e,a,t){var n=x.getClass(e),l=x.getDataList(e)||[];n.layBody.find('input[name="layTableCheckbox"]');a&&t&&(t.split(",").forEach(function(t){var i=null;if(l.forEach(function(e){e[a]+""!=t+""||(i=e)}),i){var e=i[x.config.indexName];n.layBody.find('input[name="layTableCheckbox"][value="'+e+'"]').prop("checked",!0),n.setCheckData(e,!0)}}),n.syncCheckAll(),n.renderForm("checkbox"));return null},radioStatus:function(e){var t=null,i=x.getDataList(e)||[],a=v("input[name='"+C+e+"']:checked").val();return a=parseInt(a),i.forEach(function(e){e[x.config.indexName]==a&&(t=e)}),x.clearCacheKey(t)},setRadioStatus:function(e,t,i){var a=null,n=x.getDataList(e)||[];if(t&&i&&(n.forEach(function(e){e[t]+""!=i+""||(a=e)}),a)){var l=a[x.config.indexName];v("input:radio[name='"+C+e+"'][value='"+l+"']").prop("checked",!0),o.render("radio")}return a},clearCacheKey:function(e){return delete(e=v.extend({},e))[x.config.cols.isCheckName],delete e[x.config.indexName],e},query:function(e,t){var i=x.getClass(e);i.renderTdCss(),i.config.data&&i.config.data.constructor===Array&&delete i.config.data,i.config=v.extend({},i.config,t),i.pullData(i.page,i.loading())},reload:function(e,t){var i=a.config[e];return t=t||{},i?(t.data&&t.data.constructor===Array&&delete i.data,x.render(v.extend(!0,{},i,t))):h.error("The ID option was not found in the table instance")},addRow:function(e,t,i){var a=x.getClass(e),n=a.config,l=(x.getDataMap(e),x.getDataTreeList(e)),o=x.getDataList(e)||[];if(a.resetData(i),o.splice(t,0,i),x.kit.restNumbers(o),x.setDataMap(e,a.resetDataMap(o)),n.isTree){var r=a.treeFindUpData(i);if(r){r.children;r.children.push(i),i[x.config.cols.level]=r[x.config.cols.level]+1,a.treeNodeOpen(r,!0),a.renderTreeConvertShowName(r)}else i[x.config.cols.level]=1,l.push(i)}var c=a.renderTr(i,i[x.config.indexName]),s='<tr data-index="'+i[x.config.indexName]+'"'+a.renderTrUpids(i)+">"+c.join("")+"</tr>";if(0==t){var d=a.layBody.find("table tbody");v(d).prepend(s),a.layBody.find(".layui-none").remove()}else{var f=a.layBody.find("[data-index="+(t-1)+"]");v(f).after(s)}a.renderForm(),a.renderPage(a.config.page.count+1),a.restNumbers(),a.events()},delRow:function(e,t){var i=x.getClass(e),a=i.config,n=x.getDataList(e),l=[],o={},r=[],c=[];if(i&&t){x.kit.isArray(t)?r=t:r[0]=t,r.forEach(function(e){var t=i.treeFindUpData(e);t&&c.push(t)}),(l=a.isTree?x.treeFindSonList(i.config.id,r):r).forEach(function(e){var t=e[x.config.indexName];o[t]=t,i.layBody.find('tr[data-index="'+t+'"]').remove()}),i.restNumbers();for(var s=[],d=0,f=n.length;d<f;d++){var u=!0;l.forEach(function(e){e[x.config.indexName]===n[d][x.config.indexName]&&(u=!1)}),u&&s.push(n[d])}x.kit.restNumbers(s),c.forEach(function(e){i.renderTreeConvertShowName(e)}),a.isPage&&i.renderPage(i.config.page.count-Object.keys(o).length),x.setDataList(e,s),x.setDataMap(e,i.resetDataMap(s)),x.setDataTreeList(e,i.resetDataTreeList(s,x.getDataRootList(e))),i.events()}},treeNodeOpen:function(e,t,i){var a=x.getClass(e);a&&t&&a.treeNodeOpen(t,i)},treeOpenAll:function(e,t){var i=x.getClass(e);if(i){void 0===t&&(t=!0);var a=x.getDataList(e);a&&a.forEach(function(e){i.treeNodeOpen(e,t)})}},treeFindSonList:function(e,t){var i=x.getClass(e);if(!i||!t)return[];var a=[],n=[],l={};return x.kit.isArray(t)?a=t:a[0]=t,a.forEach(function(e){0<e.children.length&&i.treeFindSonData(e).forEach(function(e){l[e[x.config.indexName]]||(n.push(e),l[e[x.config.indexName]]=e[x.config.indexName])});n.push(e),l[e[x.config.indexName]]=e[x.config.indexName]}),n},treeFindUpDatas:function(e,t){var i=x.getClass(e);return i&&t?i.treeFindUpDatas(t):[]},treeFindSonIds:function(e,t){var i=[];return x.treeFindSonList(e,t).forEach(function(e){i.push([x.config.indexName])}),i},treeFindSonIdFields:function(e,t){var i=[],a=x.getClass(e);return x.treeFindSonList(e,t).forEach(function(e){i.push(e[a.config.idField])}),i},treeIconRender:function(e,t){var i=x.getClass(e);return i&&t?i.treeIconRender(t,!1):[]},kit:{isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isNumber:function(e){return!(!/^\d+(\.\d+)?$/.test(e)&&!/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(e))},restNumbers:function(e){if(e){var t=0;e.forEach(function(e){e[x.config.indexName]=t,t++})}}}},a=function(){var t=this,e=t.config,i=e.id;return i&&(a.config[i]=e),{reload:function(e){t.reload.call(t,e)},config:e}},p="treeGrid",n=".layui-table",y="layui-hide",g="layui-none",r="layui-table-view",c=".layui-table-header",d=".layui-table-body",D=".layui-table-sort",k="layui-table-edit",i="layui-table-hover",C="table_radio_",s="treeId",f="treeUpId",w="treeShowName",l=function(e){return['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',(e=e||{}).fixed&&"right"!==e.fixed?'{{# if(item2.fixed && item2.fixed !== "right"){ }}':"right"===e.fixed?'{{# if(item2.fixed === "right"){ }}':"",'<th data-field="{{ item2.field||i2 }}" {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} {{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}} {{# if(item2.unresize){ }}data-unresize="true"{{# } }}>','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colspan > 1){ }}","group","{{# } else { }}","{{d.index}}-{{item2.field || i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose">',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(!(item2.colspan > 1) && item2.sort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc"></i><i class="layui-edge layui-table-sort-desc"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",e.fixed?"{{# }; }}":"","{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},N=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),L=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}}" lay-filter="LAY-table-{{d.index}}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool">','<div class="layui-table-tool-temp"></div>','<div class="layui-table-tool-self"></div>',"</div>","{{# } }}",'<div class="layui-table-box">',"{{# var left, right; }}",'<div class="layui-table-header">',l(),"</div>",'<div class="layui-table-filter">',void 0,"</div>",'<div class="layui-table-body layui-table-main">',N,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',l({fixed:!0}),"</div>",'<div class="layui-table-body">',N,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',l({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',N,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.isPage){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","</div>"].join(""),T=v(window),F=v(document),S=function(e){var t=this;t.index=++x.index,t.config=v.extend({},t.config,x.config,e),t.configFirst=v.extend({},t.config,x.config,e),t.render(),x.pushClass(e.id,t)};S.prototype.config={limit:10,loading:!0,cellMinWidth:60,heightRemove:[],defaultToolbar:["back"],text:{none:"无数据"},isFilter:!1,method:"post",radDisabledNum:0,cheDisabledNum:0,branch:["&#xe622;","&#xe624;"],leaf:"&#xe621;",iconOpen:!0,isOpenDefault:!0,parseData:null,onClickRow:null,onDblClickRow:null,onBeforeCheck:null,isTree:!0,isPage:!1},S.prototype.configFirst={},S.prototype.render=function(){var e=this,t=e.config;if(t.elem=v(t.elem),t.where=t.where||{},t.id=t.id||t.elem.attr("id"),e.test(),t.request=v.extend({pageName:"page",limitName:"limit"},t.request),t.response=v.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",countName:"count"},t.response),"object"==typeof t.page&&(t.limit=t.page.limit||t.limit,t.limits=t.page.limits||t.limits,e.page=t.page.curr=t.page.curr||1,delete t.page.elem,delete t.page.jump),!t.elem[0])return e;e.columnWidthInit();var i=t.elem,a=i.next("."+r),n=e.elem=v(u(L).render({VIEW_CLASS:r,data:t,index:e.index}));if(t.index=e.index,a[0]&&a.remove(),i.after(n),e.renderTdCss(),e.layHeader=n.find(c),e.layMain=n.find(".layui-table-main"),e.layBody=n.find(d),e.layFixed=n.find(".layui-table-fixed"),e.layFixLeft=n.find(".layui-table-fixed-l"),e.layFixRight=n.find(".layui-table-fixed-r"),e.layTool=n.find(".layui-table-tool"),e.layPage=n.find(".layui-table-page"),e.layFilter=n.find(".layui-table-filter"),e.renderToolbar(),t.height&&(e.tableHeight(),e.fullSize(),e.renderCss()),1<t.cols.length){var l=e.layFixed.find(c).find("th");l.height(e.layHeader.height()-1-parseFloat(l.css("padding-top"))-parseFloat(l.css("padding-bottom")))}t.isFilter&&e.layFilter.html(e.renderFilter()),e.pullData(e.page),e.test()},S.prototype.renderToolbar=function(){var e=this.config,t=['<div class="layui-inline" lay-event="add"><i class="layui-icon layui-icon-add-1"></i></div>','<div class="layui-inline" lay-event="update"><i class="layui-icon layui-icon-edit"></i></div>','<div class="layui-inline" lay-event="delete"><i class="layui-icon layui-icon-delete"></i></div>'].join(""),i=this.layTool.find(".layui-table-tool-temp");if("default"===e.toolbar)i.html(t);else if(e.toolbar){var a=v(e.toolbar).html()||"";a&&i.html(u(a).render(e))}var n={back:{title:"返回",layEvent:"LAYTABLE_BACK",icon:"layui-icon-return"}},l=[];"object"==typeof e.defaultToolbar&&layui.each(e.defaultToolbar,function(e,t){var i=n[t];i&&l.push('<div class="layui-inline" title="'+i.title+'" lay-event="'+i.layEvent+'"><i class="layui-icon '+i.icon+'"></i></div>')}),this.layTool.find(".layui-table-tool-self").html(l.join(""))},S.prototype.initOpts=function(e){var t=this.config;e.checkbox&&(e.type="checkbox"),e.space&&(e.type="space"),e.type||(e.type="normal"),"normal"!==e.type&&(e.unresize=!0,e.width=e.width||x.config.initWidth[e.type]),t.isFilter&&0!=e.isFilter&&(e.isFilter=!0)},S.prototype.getParentDivHeight=function(e){return v("#"+e).parent().height()},S.prototype.getCols=function(e){var t=this.config.cols[0],i=!1;for(var a in/^[0-9]+.?[0-9]*$/.test(e)&&(i=!0),t)if(i){if(a==parseInt(e))return t[a]}else if(e==t[a].field)return t[a];return{}},S.prototype.reload=function(e){var t=this;t.config.data&&t.config.data.constructor===Array&&delete t.config.data,t.config=v.extend({},t.config,e),t.configFirst=v.extend({},t.config,e),t.render()},S.prototype.page=1,S.prototype.restNumbers=function(){this.config;var e=this.layBody.find("table tbody tr"),t=0;e.each(function(e){v(this).attr("data-index",t),v(this).find(".laytable-cell-numbers p").text(t+1),v(this).data("index",t),t++})},S.prototype.resetData=function(e){var t=this.config;t.isTree&&(e.hasOwnProperty(x.config.cols.isOpen)||(e[x.config.cols.isOpen]=t.isOpenDefault),e.hasOwnProperty(x.config.cols.isShow)||(e[x.config.cols.isShow]=!!t.isOpenDefault)),e.hasOwnProperty(x.config.cols.cheDisabled)||(e[x.config.cols.cheDisabled]=!1),e[x.config.cols.cheDisabled]&&t.cheDisabledNum++,e[x.config.cols.radDisabled]&&t.radDisabledNum++,e.children=[]},S.prototype.resetDataMap=function(e){var t=this.config[s],i={};return e.forEach(function(e){i[e[t]]=e}),i},S.prototype.resetDataresetRoot=!0,S.prototype.resetDataRoot=function(e){var t=this.config,i=(t[s],t[f]),a=x.getDataMap(this.config.id),n=x.cache[t.id].data.upIds||[],l={};x.cache[t.id].data.upIds=[],n=x.cache[t.id].data.upIds;for(var o=0;o<e.length;o++){var r=e[o];if(!a[r[i]]){if(!l[r[i]]){var c=!0;n.forEach(function(e){e===r[i]&&(c=!1)}),c&&n.push(r[i])}l[r[i]]=r[i]}}return n},S.prototype.resetDataTreeList=function(n,e){var t=this.config,l=t[s],o=t[f],i=[],r=function(e){for(var t=[],i=0;i<n.length;i++){var a=n[i];a[o]===e&&(a.children=r(a[l]),t.push(a))}return t};return e.forEach(function(e){var t=r(e);t&&t.forEach(function(e){i.push(e)})}),i},S.prototype.resetDataTableList=function(e){var i=this,t=i.config,n=(t[s],t[f],[]),l=function(e,t){for(var i=0;i<e.length;i++){var a=e[i];a[x.config.cols.level]=t,n.push(a),a.children&&0<a.children.length&&l(a.children,1+t)}};return l(e,1),n.forEach(function(e){var t=i.treeFindUpData(e);!t||t[x.config.cols.isOpen]&&t[x.config.cols.isShow]?e[x.config.cols.isShow]=!0:e[x.config.cols.isShow]=!1}),n},S.prototype.resetDatas=function(e){var t=this,i=t.config,a=(i[s],i[f],[]),n=[],l=e,o=t.resetDataMap(e);if(a.push(l),a.push(n),a.push(o),x.setDataList(t.config.id,l),x.setDataTreeList(t.config.id,n),x.setDataMap(t.config.id,o),null==e||e.length<=0)return a;for(var r=0;r<e.length;r++)t.resetData(e[r]);if(i.isTree){l=[],x.setDataList(t.config.id,l);var c=x.cache[i.id].data.upIds||[];(c.length<=0||t.resetDataresetRoot)&&(x.cache[i.id].data.upIds=[],c=t.resetDataRoot(e),t.resetDataresetRoot=!1),n=t.resetDataTreeList(e,c),x.setDataTreeList(t.config.id,n),l=t.resetDataTableList(n),x.setDataList(t.config.id,l)}return a},S.prototype.treeFindDataById=function(t){var e=this.config,i=null,a=x.getDataList(this.key),n=e[s];return a.forEach(function(e){e[n]!=t||(i=e)}),i},S.prototype.treeFindUpData=function(e){var t=this.config[f];return x.getDataMap(this.config.id)[e[t]]},S.prototype.treeFindUpDatas=function(e){var i=this,a=(i.config,[]),n=function(e){var t=i.treeFindUpData(e);t&&(a.push(t),n(t))};return n(e),a},S.prototype.treeFindSonData=function(e){var i=[];return function t(e){0<e.children.length&&e.children.forEach(function(e){i.push(e),0<e.children.length&&t(e)})}(e),i},S.prototype.treeConvertShowName=function(i){var e,t,a=this,n=(a.config,i.children&&0<i.children.length);return'<div style="float: left;height: 28px;line-height: 28px;padding-left: '+(n?"5px":"21px")+'">'+function(){for(var e="<i>",t=1;t<i[x.config.cols.level];t++)e+="&nbsp;&nbsp;&nbsp;&nbsp;";return e+="</i>"}()+(e="",t=i[x.config.cols.isOpen]?"&#xe625;":"&#xe623;",n?e='<i class="layui-icon layui-tree-head">'+t+"</i>"+a.treeIconRender(i,!0):e+=a.treeIconRender(i,!0),e)+"</div>"},S.prototype.treeNodeOpen=function(n,e){var l=this,t=(l.config,l.layBody.find('tr[data-index="'+n[x.config.indexName]+'"]'));n[x.config.cols.isOpen]=e;var o=function(e){if(e.children&&0<e.children.length)for(var t=e.children,i=0;i<t.length;i++){var a=t[i];if(n[x.config.cols.isOpen]){if(e[x.config.cols.isOpen]&&e[x.config.cols.isShow])l.layBody.find('tr[data-index="'+a[x.config.indexName]+'"]').show(),a[x.config.cols.isShow]=!0}else l.layBody.find('tr[data-index="'+a[x.config.indexName]+'"]').hide(),a[x.config.cols.isShow]=!1;o(a)}};o(n),l.treeIconRender(n,!1);var i=t.find(".layui-tree-head");n[x.config.cols.isOpen]?i.html("&#xe625;"):i.html("&#xe623;")},S.prototype.treeIconRender=function(t,e){var i=this,a=i.config,n=a.iconOpen,l=t.children&&0<t.children.length,o="";if(!n)return o;var r=function(){var e='<i class="layui-tree-'+t[a.idField]+'" style="display:inline-block;width: 16px;height: 16px;background:url(';return l?t[x.config.cols.isOpen]?e+=t[x.config.cols.iconOpen]:e+=t[x.config.cols.iconClose]:e+=t[x.config.cols.icon],e+=') 0 0 no-repeat;"></i>'};if(l?o=t[x.config.cols.iconOpen]||t[x.config.cols.iconClose]?r():'<i class="layui-icon layui-tree-'+t[a.idField]+" layui-tree-"+(t[x.config.cols.isOpen]?"branch":"leaf")+'" '+n+">"+(t[x.config.cols.isOpen]?i.config.branch[1]:i.config.branch[0])+"</i>":t[x.config.cols.icon]?o=r():o+='<i class="layui-icon layui-tree-'+t[a.idField]+' layui-tree-leaf"  '+n+">"+i.config.leaf+"</i>",e)return o;var c=i.layBody.find('tr[data-index="'+t[x.config.indexName]+'"]').find("td[data-field="+a[w]+"]").find(".layui-table-cell");v(c).find("div .layui-tree-"+t[a.idField]).remove(),v(c).find("div").append(o)},S.prototype.pullData=function(t,i){var a=this,n=a.config,e=n.request,l=n.response,o=function(){"object"==typeof n.initSort&&a.sort(n.initSort.field,n.initSort.type)};if(a.startTime=(new Date).getTime(),n.url){var r={};r[e.pageName]=t,r[e.limitName]=n.limit;var c=a.layFilter.find("[name^='filter_']");layui.each(c,function(e,t){r[t.name]=v(t).val()}),v.ajax({type:n.method||"get",url:n.url,data:v.extend(r,n.where),dataType:"json",success:function(e){a.resetDataresetRoot=!0,"function"==typeof n.parseData&&(e=n.parseData(e)||e),a.resetDatas(e[l.dataName]),e[l.dataName]=x.getDataList(n.id),e[l.statusName]!=l.statusCode?(a.renderForm(),a.layMain.html('<div class="'+g+'">'+(e[l.msgName]||"返回的数据状态异常")+"</div>")):(a.renderData(e,t,e[l.countName]),o(),n.time=(new Date).getTime()-a.startTime+" ms"),i&&m.close(i),a.events(),"function"==typeof n.done&&n.done(e,t,e[l.countName])},error:function(e,t){a.layMain.html('<div class="'+g+'">treeGrid:数据接口请求异常</div>'),a.renderForm(),i&&m.close(i)}})}else if(n.data&&n.data.constructor===Array){var s={},d=t*n.limit-n.limit;s[l.dataName]=n.data.concat().splice(d,n.limit),s[l.countName]=n.data.length,a.renderData(s,t,n.data.length),o(),a.events(),"function"==typeof n.done&&n.done(s,t,s[l.countName])}},S.prototype.eachCols=function(i){var n=v.extend(!0,[],this.config.cols),l=[],o=0;layui.each(n,function(t,e){layui.each(e,function(e,i){if(1<i.colspan){var a=0;o++,i.CHILD_COLS=[],layui.each(n[t+1],function(e,t){t.PARENT_COL||a==i.colspan||(t.PARENT_COL=o,i.CHILD_COLS.push(t),a+=1<t.colspan?t.colspan:1)})}i.PARENT_COL||l.push(i)})});var a=function(e){layui.each(e||l,function(e,t){if(t.CHILD_COLS)return a(t.CHILD_COLS);i(e,t)})};a()},S.prototype.renderTreeConvertShowName=function(e){var t=this.config,i=(t.elem.next("."+r),this.treeConvertShowName(e)),a=this.layBody.find('tr[data-index="'+e[x.config.indexName]+'"]').find("td[data-field="+t[w]+"]").find(".layui-table-cell");v(a).find("div").remove(),v(a).prepend(i)},S.prototype.renderTdCss=function(){var i=this,e=i.config.elem.next("."+r),t=i.index+"_"+p+"_td_style";e.find("#"+t).remove();var a,n='<style id="'+t+'">'+(a="",layui.each(i.config.cols,function(e,t){layui.each(t,function(e,t){a+=".laytable-cell-"+i.index+"-"+(t.field||e)+"{width:"+(t.width?t.width+"px":"0px")+"}"})}),a)+"</style>";e.append(n)},S.prototype.renderCss=function(){var e=this.config.elem.next("."+r),t=this.index+"_"+p+"_style";e.find("#"+t).remove();var i='<style id="'+t+'">.layui-tree-head{cursor: pointer;}.layui-table-view {margin:0;}</style>';e.append(i)},S.prototype.renderTrUpids=function(e){var t=this.config,i=t[f],a=(e.upIds,' u_id="'+e[i]+'" ');return t.isTree?a:""},S.prototype.renderTd=function(e){var t,i,n=this.config,l=e.cols,o=e.obj,r=e.numbers,a=e.i3,c=null==o[l.field]?"":String(o[l.field]),s=l.field||a,d=c,f=(this.getColElem(this.layHeader,s),"");return n.isTree&&n.treeShowName==l.field&&(f=this.treeConvertShowName(o)),['<td data-field="'+s+'" '+(i=[],l.edit&&i.push('data-edit="'+l.edit+'"'),l.align&&i.push('align="'+l.align+'"'),l.templet&&i.push('data-content="'+d+'"'),l.toolbar&&i.push('data-off="true"'),l.event&&i.push('lay-event="'+l.event+'"'),l.style&&i.push('style="'+l.style+'"'),l.minWidth&&i.push('data-minwidth="'+l.minWidth+'"'),i.join(" "))+">",'<div class="layui-table-cell laytable-cell-'+(t=n.index+"-"+s,"normal"===l.type?t:t+" laytable-cell-"+l.type)+'">'+f+'<p style="width: auto;height: 100%;">'+function(){var e,t,i=v.extend(!0,{LAY_INDEX:r},o);if("checkbox"===l.type)return i[x.config.cols.cheDisabled]?"":'<input type="checkbox" name="layTableCheckbox" value="'+i[x.config.indexName]+'" lay-skin="primary" '+(t=x.config.cols.isCheckName,l[t]?(o[t]=l[t],l[t]?"checked":""):i[t]?"checked":"")+">";if("numbers"===l.type)return r;if("drop"===l.type){var a=dl.ui.table.drop.findFieldObj(n.cols[0],s);if(a&&a.drop){dl.cache.code.get(a.drop);return dl.ui.table.drop.findDropLable(a.drop,d)}}else if("radio"===l.type)return i[x.config.cols.radDisabled]?"":'<input type="radio" name="'+C+n.id+'" '+(e=x.config.cols.isRadio,l[e]?(o[e]=l[e],l[e]?"checked":""):i[e]?"checked":"")+' value="'+i[x.config.indexName]+'" title=" ">';return l.toolbar?u(v(l.toolbar).html()||"").render(i):l.templet?"function"==typeof l.templet?l.templet(i):u(v(l.templet).html()||String(d)).render(i):d}(),"</p></div></td>"].join("")},S.prototype.renderTr=function(l,o){var r=this,c=(r.config,[]);return r.eachCols(function(e,t){var i=t.field||e,a=l[i];r.getColElem(r.layHeader,i);if(null==a&&(a=""),!(1<t.colspan)){var n=r.renderTd({obj:l,numbers:o,cols:t,i3:e});c.push(n)}}),c},S.prototype.renderData=function(e,l,t,o){var r=this,c=r.config,i=e[c.response.dataName]||[],s=[],d=[],f=[],a=function(){if(!o&&r.sortKey)return r.sort(r.sortKey.field,r.sortKey.sort,!0);layui.each(i,function(e,t){r.treeFindUpData(t);var i="";!t[x.config.cols.isShow]&&c.isTree&&(i="display: none;");var a=[],n=e+c.limit*(l-1)+1;0!==t.length&&(o||(t[x.config.indexName]=e),a=r.renderTr(t,n),s.push('<tr style="'+i+'" data-index="'+e+'" '+r.renderTrUpids(t)+">"+a.join("")+"</tr>"),d.push('<tr data-index="'+e+'">'+[].join("")+"</tr>"),f.push('<tr data-index="'+e+'">'+[].join("")+"</tr>"))}),r.layBody.scrollTop(0),r.layMain.find("."+g).remove(),r.layMain.find("tbody").html(s.join("")),r.layFixLeft.find("tbody").html(d.join("")),r.layFixRight.find("tbody").html(f.join("")),r.renderForm(),r.syncCheckAll(),r.haveInit?r.scrollPatch():setTimeout(function(){r.scrollPatch()},50),r.haveInit=!0,m.close(r.tipsIndex)};return r.key=c.id||c.index,x.setDataList(r.key,i),r.layPage[0===i.length&&1==l?"addClass":"removeClass"](y),o?a():0===i.length?(r.renderForm(),r.layFixed.remove(),r.layMain.find("tbody").html(""),r.layMain.find("."+g).remove(),r.layMain.append('<div class="'+g+'">'+c.text.none+"</div>")):(a(),r.renderPage(t),x.pushClassIds(c.id,!0),r.syncCheckAll(),void layui.each(c.cols,function(e,t){layui.each(t,function(e,t){})}))},S.prototype.renderPage=function(e){var i=this,a=i.config;a.isPage&&(a.page=v.extend({elem:"layui-table-page"+a.index,count:e,limit:a.limit,limits:a.limits||[10,15,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(e,t){t||(i.page=e.curr,a.limit=e.limit,i.pullData(e.curr,i.loading()))}},a.page),a.page.count=e,t.render(a.page))},S.prototype.renderFilter=function(){var e=this.config,c=this.index,s=[];return s.push('<form method="post"  id="'+e.id+'_filter_form">'),s.push('<table cellspacing="0" cellpadding="0" border="0" class="layui-table"><thead><tr>'),layui.each(e.cols,function(e,t){layui.each(t,function(e,t){var i,a=t.field||e,n=t.minWidth?"data-minwidth='"+t.minWidth+"'":"",l=t.colspan?'colspan="'+t.colspan+'"':"",o=t.rowspan?'rowspan="'+t.rowspan+'"':"",r=t.unresize?'data-unresize="true"':"";s.push('<th data-field="'+a+'"'+n+l+o+r+">"),s.push('<div class="layui-table-cell laytable-cell-'+(i="",1<t.colspan?i="group":(i=c+"-"+a,"normal"!==t.type&&(i+=" laytable-cell-"+t.type)),i)+'">'),t.isFilter&&t.field?s.push('<input class="layui-input '+k+'" id="filter_'+t.field+'" name="filter_'+t.field+'">'):s.push(""),s.push("</div></th>")})}),s.push("</tr></thead></table>"),s.push("</form>"),s.join("")},S.prototype.getColElem=function(e,t){var i=this.config;return e.eq(0).find(".laytable-cell-"+i.index+"-"+t+":eq(0)")},S.prototype.renderForm=function(e){o.render(e,"LAY-table-"+this.index)},S.prototype.sort=function(n,e,t,i){var a,l=this,o={},r=l.config,c=r.elem.attr("lay-filter"),s=x.getDataList(l.key);"string"==typeof n&&l.layHeader.find("th").each(function(e,t){var i=v(this),a=i.data("field");if(a===n)return n=i,d=a,!1});try{var d=d||n.data("field");if(l.sortKey&&!t&&d===l.sortKey.field&&e===l.sortKey.sort)return;var f=l.layHeader.find("th .laytable-cell-"+r.index+"-"+d).find(D);l.layHeader.find("th").find(D).removeAttr("lay-sort"),f.attr("lay-sort",e||null),l.layFixed.find("th")}catch(e){return h.error("Table modules: Did not match to field")}l.sortKey={field:d,sort:e},"asc"===e?a=layui.sort(s,d):"desc"===e?a=layui.sort(s,d,!0):(a=layui.sort(s,x.config.indexName),delete l.sortKey),o[r.response.dataName]=a,l.renderData(o,l.page,l.count,!0),i&&layui.event.call(n,p,"sort("+c+")",{field:d,type:e})},S.prototype.loading=function(){var e=this,t=e.config;if(t.loading&&t.url)return m.msg("数据请求中",{icon:16,offset:[e.elem.offset().top+e.elem.height()/2-35-T.scrollTop()+"px",e.elem.offset().left+e.elem.width()/2-90-T.scrollLeft()+"px"],time:-1,anim:-1,fixed:!1})},S.prototype.setCheckData=function(e,t){this.config;var i=x.getDataList(this.key);i[e]&&i[e].constructor!==Array&&(i[e][x.config.cols.isCheckName]=t)},S.prototype.syncCheckAll=function(){var t=this,e=t.config,i=x.getDataList(t.config.id);if(i){var a=!0,n=0;if(i.forEach(function(e){e[x.config.cols.cheDisabled]||(e[x.config.cols.isCheckName]?(t.layBody.find("tr[data-index="+e[x.config.indexName]+"]").find('input[name="layTableCheckbox"]').prop("checked",!0),n++):(a=!1,t.layBody.find("tr[data-index="+e[x.config.indexName]+"]").find('input[name="layTableCheckbox"]').prop("checked",!1)))}),a)t.layHeader.find('input[name="layTableCheckbox"]').prop("checked",!0);if(n<i.length-e.cheDisabledNum)t.layHeader.find('input[name="layTableCheckbox"]').prop("checked",!1);t.renderForm("checkbox")}},S.prototype.getCssRule=function(i,a){var n=this,e=n.elem.find("style")[0],t=e.sheet||e.styleSheet||{},l=t.cssRules||t.rules;layui.each(l,function(e,t){if(t.selectorText===".laytable-cell-"+n.index+"-"+i)return a(t),!0})},S.prototype.test=function(){},S.prototype.resize=function(){this.columnWidthInit(),this.tableHeight(),this.fullSize(),this.resizeWidth()},S.prototype.setArea=function(){this.columnWidthInit(),this.tableHeight()},S.prototype.tableHeight=function(){var e=this,t=e.config,i=e.configFirst;if(!x.kit.isNumber(i.height)){var a=0;if(t.heightRemove&&x.kit.isArray(t.heightRemove))t.heightRemove.forEach(function(e){var t=x.kit.isNumber(e)?e:v(e).outerHeight(!0);x.kit.isNumber(t)&&(a+=t)});var n=T.height()-a-1;e.fullHeightGap=0,t.height&&/^full-\d+$/.test(t.height)&&(e.fullHeightGap=t.height.split("-")[1]),t.height=n-e.fullHeightGap}},S.prototype.columnWidthInit=function(){var a,n=this,l=n.config,e=0,o=0,r=0,c=0,s=l.width||(a=function(e){var t,i;t=(e=e||l.elem.parent()).width();try{i="none"===e.css("display")}catch(e){}return!e[0]||t&&!i?t:a(e.parent())})()-17;n.eachCols(function(){e++}),s-="line"===l.skin||"nob"===l.skin?2:e+1,layui.each(l.cols,function(e,a){layui.each(a,function(e,t){var i;t?(n.initOpts(t),i=t.width||0,1<t.colspan||(/\d+%$/.test(i)?t.width=i=Math.floor(parseFloat(i)/100*s):!t._is_width_dev&&i||(t._is_width_dev=!0,t.width=i=0,o++),c+=i)):a.splice(e,1)})}),n.autoColNums=o,c<s&&o&&(r=(s-c)/o),layui.each(l.cols,function(e,t){layui.each(t,function(e,t){var i=t.minWidth||l.cellMinWidth;1<t.colspan||0===t.width&&(t.width=Math.floor(i<=r?r:i))})})},S.prototype.resizeWidth=function(){this.renderTdCss()},S.prototype.resizeHeight=function(){},S.prototype.fullSize=function(){var e,t=this,i=t.config,a=i.height;a<135&&(a=135),t.elem.css("height",a);var n=i.isFilter?76:38;e=parseFloat(a)-n-1,i.toolbar&&(e-=t.layTool.outerHeight()),i.isPage&&(e=e-t.layPage.outerHeight()-1),t.layMain.css("height",e)},S.prototype.getScrollWidth=function(e){var t=0;return e?t=e.offsetWidth-e.clientWidth:((e=document.createElement("div")).style.width="100px",e.style.height="100px",e.style.overflowY="scroll",document.body.appendChild(e),t=e.offsetWidth-e.clientWidth,document.body.removeChild(e)),t},S.prototype.scrollPatch=function(){var i=this,e=i.layMain.children("table"),t=i.layMain.width()-i.layMain.prop("clientWidth"),a=i.layMain.height()-i.layMain.prop("clientHeight"),n=i.getScrollWidth(i.layMain[0]),l=e.outerWidth()-i.layMain.width();if(i.autoColNums&&l<5&&!i.scrollPatchWStatus){var o=i.layHeader.eq(0).find("thead th:last-child"),r=o.data("field");i.getCssRule(r,function(e){var t=e.style.width||o.outerWidth();e.style.width=parseFloat(t)-n-l+"px",0<i.layMain.height()-i.layMain.prop("clientHeight")&&(e.style.width=parseFloat(e.style.width)-1+"px"),i.scrollPatchWStatus=!0})}if(t&&a){if(i.elem.find(".layui-table-patch").length<=0){var c=v('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>');c.find("div").css({width:t}),i.layHeader.eq(0).find("thead tr").append(c)}}else i.layFilter.eq(0).find(".layui-table-patch").remove(),i.layHeader.eq(0).find(".layui-table-patch").remove();var s=i.layMain.height()-a;i.layFixed.find(d).css("height",e.height()>s?s:"auto"),i.layFixRight[0<l?"removeClass":"addClass"](y),i.layFixRight.css("right",t-1)},S.prototype.events=function(){var n,l=this,a=l.config,o=v("body"),r={},e=l.layHeader.find("th"),t=l.layBody.find("tr"),c=a.elem.attr("lay-filter");l.layTool.unbind("click").on("click","*[lay-event]",function(e){var t=v(this),i=t.attr("lay-event");switch(layui.stope(e),F.trigger("table.tool.panel.remove"),m.close(l.tipsIndex),i){case"LAYTABLE_BACK":history.back(-1)}layui.event.call(this,p,"toolbar("+c+")",v.extend({event:i,config:a},{}))}),t.unbind("click").on("click",function(e){var t=v(this).attr("data-index"),i=x.getDataList(l.config.id)[t];"function"==typeof a.onClickRow&&a.onClickRow(t,i)}),t.unbind("dblclick").on("dblclick",function(e){var t=v(this).attr("data-index"),i=x.getDataList(l.config.id)[t];l.config.onDblClickRow(t,i)}),e.unbind("mousemove").on("mousemove",function(e){var t=v(this),i=t.offset().left,a=e.clientX-i;1<t.attr("colspan")||t.data("unresize")||r.resizeStart||(r.allowResize=t.width()-a<=10,o.css("cursor",r.allowResize?"col-resize":""))}),e.unbind("mouseleave").on("mouseleave",function(){v(this);r.resizeStart||o.css("cursor","")}),e.unbind("mousedown").on("mousedown",function(e){var i=v(this);if(r.allowResize){var t=i.data("field");e.preventDefault(),r.resizeStart=!0,r.offset=[e.clientX,e.clientY],l.getCssRule(t,function(e){var t=e.style.width||i.outerWidth();r.rule=e,r.ruleWidth=parseFloat(t),r.minWidth=i.data("minwidth")||a.cellMinWidth})}}),F.unbind("mousemove").on("mousemove",function(e){if(r.resizeStart){if(e.preventDefault(),r.rule){var t=r.ruleWidth+e.clientX-r.offset[0];t<r.minWidth&&(t=r.minWidth),r.rule.style.width=t+"px",m.close(l.tipsIndex)}n=1}}),F.unbind("mouseup").on("mouseup",function(e){r.resizeStart&&(r={},o.css("cursor",""),l.scrollPatch()),2===n&&(n=null)}),e.unbind("click").on("click",function(){var e,t=v(this),i=t.find(D),a=i.attr("lay-sort");if(!i[0]||1===n)return n=2;e="asc"===a?"desc":"desc"===a?null:"asc",l.sort(t,e,null,!0)}),e.find(D+" .layui-edge ").unbind("click").on("click",function(e){var t=v(this),i=t.index(),a=t.parents("th").eq(0).data("field");layui.stope(e),0===i?l.sort(a,"asc",null,!0):l.sort(a,"desc",null,!0)}),l.eventsinitIsRun||(l.eventsinit(),l.eventsinitIsRun=!0),l.layMain.unbind("scroll").on("scroll",function(){var e=v(this),t=e.scrollLeft(),i=e.scrollTop();l.layHeader.scrollLeft(t),l.layFilter.scrollLeft(t),l.layFixed.find(d).scrollTop(i),m.close(l.tipsIndex)}),T.unbind("resize").on("resize",function(){l.resize()})},S.prototype.eventsinitIsRun=!1,S.prototype.eventsinit=function(){var y=this,r=y.config,g=".layui-table-cell",c=r.elem.attr("lay-filter");y.layFilter.on("keyup","[name^='filter_']",function(){y.page=1,y.pullData(y.page,y.loading())}),y.layBody.on("mouseenter","tr",function(){var e=v(this).index();y.layBody.find("tr:eq("+e+")").addClass(i)}),y.layBody.on("mouseleave","tr",function(){var e=v(this).index();y.layBody.find("tr:eq("+e+")").removeClass(i)}),y.layBody.on("click","td div.layui-table-cell p",function(){var e=v(this).parent().parent(),t=e.data("field"),i=e.data("edit"),a=e.parents("tr").eq(0).data("index"),n=x.getDataList(y.key)[a],l=e.children(g),o=y.config;if(m.close(y.tipsIndex),!e.data("off"))if(i)if("select"===i){e.data("drop");var r=dl.ui.table.drop.findFieldObj(o.cols[0],t),c="",s=dl.cache.code.get(r.drop).syscodevaluecache;for(var d in s){var f="";s[d].scv_value==n[t]&&(f="selected='selected'"),c+="<option "+f+'  value="'+s[d].scv_value+'">'+s[d].scv_show_name+"</option>"}var u=v('<select class="'+k+'" lay-ignore>'+c+"</select>");e.find("."+k)[0]||e.append(u)}else{var h=v('<input class="layui-input '+k+'">');h[0].value=v.trim(v(this).text()),e.find("."+k)[0]||e.append(h),h.focus()}else{var p=y.getCols(t);if(!x.config.initWidth[p.type]){if(l.find(".layui-form-switch,.layui-form-checkbox")[0])return;Math.round(l.prop("scrollWidth"))>Math.round(l.outerWidth())&&(y.tipsIndex=m.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(l.height()+16)+"px;"+("sm"===o.size?"padding: 4px 15px; font-size: 12px;":"lg"===o.size?"padding: 14px 15px;":"")+'">',l.html(),"</div>",'<i class="layui-icon layui-table-tips-c">&#x1006;</i>'].join(""),l[0],{tips:[3,""],time:-1,anim:-1,maxWidth:b.ios||b.android?300:600,isOutAnim:!1,skin:"layui-table-tips",success:function(e,t){e.find(".layui-table-tips-c").on("click",function(){m.close(t)})}}))}}}),y.layBody.on("change","."+k,function(){var e=v(this),t=this.value,i=e.parent().data("field"),a=e.parents("tr").eq(0).data("index"),n=x.getDataList(y.key)[a];n[i]=t,layui.event.call(this,p,"edit("+c+")",{value:t,data:n,field:i})}),y.layBody.on("blur","."+k,function(){var i,e=v(this),a=e.parent().data("field"),t=e.parents("tr").eq(0).data("index"),n=e.parent().data("edit"),l=x.getDataList(y.key)[t],o=y.config;y.eachCols(function(e,t){t.field==a&&t.templet&&(i=t.templet)});var r="";if("select"===n){var c=dl.ui.table.drop.findFieldObj(o.cols[0],a);if(c&&c.drop){dl.cache.code.get(c.drop);r=dl.ui.table.drop.findDropLable(c.drop,this.value)}e.parent().find(g+" p").html(i?u(v(i).html()||r).render(l):r)}else e.parent().find(g+" p").html(i?u(v(i).html()||this.value).render(l):this.value);e.parent().data("content",this.value),e.remove()}),y.elem.on("click","i.layui-tree-head",function(){var e=v(this).parents("tr").eq(0).data("index"),t=(y.config,x.getDataList(y.key)[e]);y.treeNodeOpen(t,!t[x.config.cols.isOpen]),y.resize()}),y.elem.on("click",'input[name="layTableCheckbox"]+',function(){var e=v(this).prev(),t=(y.layBody.find('input[name="layTableCheckbox"]'),e.parents("tr").eq(0).data("index")),i=e[0].checked,a=x.getDataList(y.config.id)[t],n="layTableAllChoose"===e.attr("lay-filter");if(n){x.getDataList(y.key).forEach(function(e){e[x.config.cols.cheDisabled]||y.setCheckData(e[x.config.indexName],i)}),y.syncCheckAll()}else{if(y.setCheckData(t,i),r.isTree){y.treeFindSonData(a).forEach(function(e){e[x.config.cols.cheDisabled]||y.setCheckData(e[x.config.indexName],i)});var l=y.treeFindUpData(a);if(l&&0<l.children.length){var o=!0;l.children.forEach(function(e){e[x.config.cols.isCheckName]||(o=!1)}),o&&y.setCheckData(l[x.config.indexName],i)}}y.syncCheckAll()}layui.event.call(this,p,"checkbox("+c+")",{checked:i,data:x.getDataList(y.key)&&a||{},type:n?"all":"one"})}),y.layBody.on("click","*[lay-event]",function(){var e=v(this),t=e.parents("tr").eq(0).data("index"),n=y.layBody.find('tr[data-index="'+t+'"]'),i="layui-table-click",l=(x.getDataList(y.key),x.getDataList(y.key)[t]);layui.event.call(this,p,"tool("+c+")",{data:l,event:e.attr("lay-event"),tr:n,del:function(){x.delRow(r.id,l)},update:function(e){e=e||{},layui.each(e,function(i,e){if(i in l){var a,t=n.children('td[data-field="'+i+'"]');l[i]=e,y.eachCols(function(e,t){t.field==i&&t.templet&&(a=t.templet)}),t.children(g).html(a?u(v(a).html()||e).render(l):e),t.data("content",e)}})}}),n.addClass(i).siblings("tr").removeClass(i)})},a.config={},x.init(),e(p,x)});